%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SU2 configuration file                                                       %
% Case description: Regression test for structural adjoints                    %
% Author: R.Sanchez                                                            %
% Institution: Imperial College London                                         %
% Date: 2017.11.29                                                             %
% File Version 6.0.0 "Falcon"                                                   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

PHYSICAL_PROBLEM= FEM_ELASTICITY
KIND_TURB_MODEL= NONE

MATH_PROBLEM= DISCRETE_ADJOINT

RESTART_SOL= NO

OBJECTIVE_FUNCTION = REFERENCE_GEOMETRY 
REFERENCE_GEOMETRY = YES

REFERENCE_GEOMETRY_FILENAME = reference_geometry.dat
REFERENCE_GEOMETRY_FORMAT = SU2
REFERENCE_GEOMETRY_PENALTY = 1E6

WRT_BINARY_RESTART=NO
READ_BINARY_RESTART=NO

MESH_FILENAME= mesh.su2

MARKER_CLAMPED = ( Clamped )
MARKER_NORMAL_LOAD= ( LowerBeamS, 0.0, UpperBeamS, 1.00, RightBeamS, 0.0)

GEOMETRIC_CONDITIONS= LARGE_DEFORMATIONS
MATERIAL_MODEL= NEO_HOOKEAN
MATERIAL_COMPRESSIBILITY= COMPRESSIBLE

ELASTICITY_MODULUS=21000
POISSON_RATIO=0.4
MATERIAL_DENSITY=100
DEAD_LOAD=NO
FORMULATION_ELASTICITY_2D = PLANE_STRAIN

NONLINEAR_FEM_SOLUTION_METHOD = NEWTON_RAPHSON
NONLINEAR_FEM_INT_ITER = 10
RESIDUAL_FEM_UTOL = -9.0
RESIDUAL_FEM_RTOL = -9.0
RESIDUAL_FEM_ETOL = -9.0

RESIDUAL_CRITERIA_FEM = ABSOLUTE

CONV_FILENAME= history
VOLUME_STRUCTURE_FILENAME= beam
WRITE_CONV_FILENAME_FSI = NO
BREAKDOWN_FILENAME= forces_breakdown.dat

SOLUTION_STRUCTURE_FILENAME= solution_beam.dat
RESTART_STRUCTURE_FILENAME= restart_beam.dat

SOLUTION_ADJ_FILENAME= solution_adj.dat
RESTART_ADJ_FILENAME= restart_adj.dat

WRT_SRF_SOL = NO
WRT_CSV_SOL = NO

MESH_FORMAT= SU2
OUTPUT_FORMAT= PARAVIEW

WRT_CON_FREQ= 1
WRT_CON_FREQ_DUALTIME= 1
WRT_SOL_FREQ= 1
WRT_SOL_FREQ_DUALTIME= 1

LINEAR_SOLVER= CONJUGATE_GRADIENT
LINEAR_SOLVER_PREC= JACOBI
LINEAR_SOLVER_ERROR= 1E-8
LINEAR_SOLVER_ITER= 1000

DISCADJ_LIN_SOLVER= CONJUGATE_GRADIENT
DISCADJ_LIN_PREC= JACOBI
